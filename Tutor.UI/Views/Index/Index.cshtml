@model Tutor.UI.ViewModels.IndexVM
@*@using Model;*@

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Lauout.cshtml";
    ViewBag.loginviewmodel = new Model.Teacher();
}
<link href="~/Css/index.css" rel="stylesheet"/>
<link href="~/Css/font-awesome.min.css" rel="stylesheet" />
<script src="~/scripts/jquery-3.3.1.js"></script>

<div class="firstdiv">
    <div class="selectdiv">
        <ul>
            <li>
                <div class="choose" id="choosegrade">
                    <span>选择年级</span>
                    <span class="fa fa-sort-desc fa-2x triangle"></span>
                    <ul>
                        @foreach (var item in Model.grade)
                        {
                                <li><span data-id="@item.Grade_id">@item.Grade1</span></li>
                        }
                    </ul>
                </div>
            </li>
            <li>
                <div class="choose" id="choosesub">
                    <span>选择学科</span>
                    <span class="fa fa-sort-desc fa-2x triangle"></span>
                    <ul>
                    </ul>
                </div>
            </li>
            <li>
                <input type="submit" value="搜索家教">
            </li>
        </ul>
    </div>
    <div class="logindiv">
        @if (Session["user_id"] == null)
        {
            @Html.Partial("_login", Model.teacher)
        }
        else
        {
            <section class="userinfo">
                <div><img src="#" /></div>
                <div><span>欢迎您，username</span></div>
                <div><button>进入个人中心</button></div>
            </section>
            <div class="after">
                <div>
                    <span>公告</span>
                </div>
                <div>
                    <ul>
                        <li>
                            <span><a href="#">常见使用问题</a></span>
                            <span>5-18</span>
                        </li>
                        <li>
                            <span><a href="#">家教价格参考</a></span>
                            <span>4-28</span>
                        </li>
                        <li>
                            <span><a href="#">搜狐网报道提优特</a></span>
                            <span>5-15</span>
                        </li>
                        <li>
                            <span><a href="#">新浪网报道提优特</a></span>
                            <span>2-28</span>
                        </li>
                        <li>
                            <span><a href="#">凤凰网报道提优特</a></span>
                            <span>4-21</span>
                        </li>
                    </ul>
                </div>
            </div>
        }        
        
    </div>
</div>
<div style="width:81%;margin:0 auto;background-color:beige;">
    <div>
        
    </div>
    <div>

    </div>
</div>
<div class="task">
    @foreach(var item in Model.task)
    {
        <div class="singlecase">
            <div class="Ttop">
                <div>@item.Student.Suser_name 急需家教</div>
                <div>辅导 @item.Subject</div>
                <div>
                    <strong>面议</strong>
                </div>
            </div>
            <div class="Tbottom">
                <span class="fa fa-location-arrow"></span>
                <span>@item.Location</span>
                <div>等待您来应聘</div>
                <a href="#">我要应聘</a>
            </div>
        </div>
    }
</div>
<script>
    //choosegrade
    $("#choosegrade").hover(function () {
        $("#choosegrade>ul").css({"display":"block","background-color":"white","z-index":"100","cursor":"pointer"});
    }).click(function (event) {
        var grade = event.target.innerText;
        $("#choosegrade>span:first-child").text(grade);
    }).mouseleave(function () {
        $("#choosegrade>ul").css("display", "none");
    });

    //choosesubject
    $("#choosesub").hover(function () {
        $("#choosesub>ul").css({ "display": "block", "background-color": "white", "z-index": "100", "cursor": "pointer"});
    }).click(function (event) {
        var subject = event.target.innerText;
        $("#choosesub>span:first-child").text(subject);
    }).mouseleave(function () {
        $("#choosesub>ul").css("display", "none");
    })
    //loginbox
    $(".choosebar span:nth-child(1)").hover(function () {
        $(".teacherbox").css("display", "block");
        $(".studentbox").css("display", "none");
        $(".choosebar span:nth-child(1)").css("border", "none");
        $(".choosebar span:nth-child(2)").css({ "border-bottom": "1px solid lightgray", "border-left": "1px solid lightgray" });
    });
    $(".choosebar span:nth-child(2)").hover(function () {
        $(".studentbox").css("display", "block");
        $(".teacherbox").css("display", "none");
        $(".choosebar span:nth-child(2)").css("border", "none");
        $(".choosebar span:nth-child(1)").css({"border-bottom":"1px solid lightgray","border-right":"1px solid lightgray"})
    })

    //获取年级和科目的数据
    $("#choosegrade ul li span").click(function (event) {
        console.log(event);
        var grade_id = event.currentTarget.dataset.id;
        $.get("/Index/getsubject/" + grade_id, function (data) {
            $("#choosesub ul").empty();
            for (var x in data) {
                var sub  = $("<li></li>").text(data[x].subject1);
                //var child=$('#choosesub ul').children().length;
                //console.log(child);
                $("#choosesub ul").append(sub);
            }
        })
    })
</script>